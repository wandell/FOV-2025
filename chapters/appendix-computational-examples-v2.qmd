---
date: last-modified
---

# Simulations {#sec-appendix-simulation}
{{< include "includes/WIP-callout.qmd" >}}

---

This section of the appendix describes many simulations of the properties of the human visual system and neural responses.  These include simulations of image formation, cone absorption characteristics, and color matching and discrimination.  

The simulations, written in Matlab, rely on two toolboxes.  The base toolbox is [ISETCam](), which is also described in the textbook [Foundations of Image Systems Engineering](https://wandell.github.io/FISE-git/), particularly in [this appendix](https://wandell.github.io/FISE-git/chapters/appendix-03-isetcam.html).

The ([ISETBIO](https://github.com/isetbio/isetbio)) toolbox extends ISETCam with many specializations for the human visual system.  Both toolboxes are open-source and freely available.

## ISETBIO Programming

The links below use the [ISETBIO](https://github.com/isetbio/isetbio/wiki) programming tools and explain the philosophy of the software organization. If you plan to use ISETBIO for simulating the visual system, these links may be useful to you. 

ISETBIO is built as an extension of [Image Systems Engineering Toolbox for Cameras (ISETCam)](https://github.com/iset/isetcam/wiki), with many additions specifically designed for simulation the front end of the human visual system (physiological optics, photoreceptor sampling, retinal ganglion cell signaling).  Both toolboxes are open-source and freely available.

ISETBIO input is a spectral radiance description of the scene. Various types of scenes can be constructed automatically, hyper spectral images can be read in and turned into scenes, and RGB scenes can be read in and converted to scenes based on a display model calibration.

The transformation of a scene spectral radiance image to a spectral irradiance image at the sensor (or retinal) surface depends on the properties of the optics. The ISETBIO object representing the spectral irradiance image is called the optical image (OI). The OI structure includes a definition of the optics, which can be based either on diffraction limited optics, shift-invariant optics, or a shift-variant ray tracing model.

## Optics

[Human optics: Part I](http://white.stanford.edu/~brian/FOV/tutorials/s_HumanOptics.html)

The line spread function is a simple measure of the quality of the optics. This script illustrates the ISET routines that implement Marimont and Wandell’s model of the human optics.

[Human optics: Part II ](http://white.stanford.edu/~brian/FOV/tutorials/s_HumanLSF.html)

This tutorial shows images of the line spread that quantify the wavelength dependence of the line spread. It also includes point spreads, optical transfer functions (OTF), and two standard polychromatic line spread functions.

[Human optics: adaptive optics](http://white.stanford.edu/~brian/FOV/tutorials/s_wvfThibosModel.html)

Adaptive optics has produced many measurements of human wavefront aberrations. A standard model of the average subject is evolving. The code in this script, being developed in collaboration with Heidi Hofer and David Brainard, implements a standard observer proposed by Larry Thibos.

## Cone absorptions

[Photon absorptions in the cone mosaic](http://white.stanford.edu/~brian/FOV/tutorials/s_HumanSensor.html)

The rate or number of photon absorptions in each type of cone is a fundamental physical factor that limits our ability to detect light, discriminate colors, and estimate form. The calculations in this script illustrate how to compute the photon absorption rates.

[Spatial pattern of cone absorptions](http://white.stanford.edu/~brian/FOV/tutorials/s_HumanSceneStatistics.html)

A white noise scene (Gaussian independent at each point, D65 spectral power distribution) is transformed by passing through the human optics. This script shows how the spatial frequency of the white noise distribution becomes a ‘blue noise’ distribution at the cone mosaic.

## Color

[Color matching: metamerism](http://white.stanford.edu/~brian/FOV/tutorials/t_ColorMetamerism.html)

Two stimuli with different spectral power distributions may still have the same effect on the three types of cones. A pair of physically different stimuli that have the same effect on the cone absorptions are called metamers. This script constructs a pair of metamers and follows them through the optics into the cone absorptions.

[Wavelength discrimination and mean illumination](http://white.stanford.edu/~brian/FOV/tutorials/s_HumanWavelengthDiscrimination.html "Wavelength Discrimination")

The ability to discriminate two different wavelengths depends on the mean level of illumination. At low levels the photon noise is a significant factor. This script calculates the discriminability of a pair of wavelengths as a function of the mean illumination level.

## Online lectures and tutorials

Click on the [Talks and Tutorials Tab](http://www.stanford.edu/group/vista/cgi-bin/wandell/talks-and-tutorials/) of [Wandell’s home page ](http://www.stanford.edu/group/vista/cgi-bin/wandell/)for a more complete list.

[Lectures from Winter 2012 (videos from talks.stanford.edu).](https://talks.stanford.edu/applied-vision-and-image-systems-psych-221/)

- [Spectral Radiance Units](http://white.stanford.edu/~brian/Videos/Psych221/Spectral%20Radiance%20Units/Spectral%20Radiance%20Units.html)
- [Measuring Radiance](http://white.stanford.edu/~brian/Videos/Psych221/Measuring%20Radiance/Measuring%20Radiance.html)
- [Spectral irradiance](http://white.stanford.edu/~brian/Videos/Psych221/Spectral%20Irradiance/Spectral%20Irradiance.html)
- [Linear Models](http://white.stanford.edu/~brian/Videos/Psych221/Linear%20Models/Linear%20Models.html)